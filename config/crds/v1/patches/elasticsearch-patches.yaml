# Using `kubectl apply` stores the complete CRD file as an annotation,
# which may be too big for the annotations size limit.
# One way to mitigate this problem is to remove the (huge) podTemplate properties from the CRD.
# It also avoids the problem of having any k8s-version specific field in the Pod schema,
# that would maybe not match the user's k8s version.
- op: remove
  path: /spec/versions/0/schema/openAPIV3Schema/properties/spec/properties/nodeSets/items/properties/podTemplate/properties
- op: remove
  path: /spec/versions/1/schema/openAPIV3Schema/properties/spec/properties/nodeSets/items/properties/podTemplate/properties

# Remove 'claims.items' field which makes the CRD invalid because 'x-kubernetes-map-type: atomic' is missing
- op: remove
  path: /spec/versions/0/schema/openAPIV3Schema/properties/spec/properties/nodeSets/items/properties/volumeClaimTemplates/items/properties/spec/properties/resources/properties/claims
- op: remove
  path: /spec/versions/1/schema/openAPIV3Schema/properties/spec/properties/nodeSets/items/properties/volumeClaimTemplates/items/properties/spec/properties/resources/properties/claims
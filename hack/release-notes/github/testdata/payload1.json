{"data":{"search":{"nodes":[{"number":3315,"title":"Fix kibana saved object encryption keys pre-7.6.0","merged":true,"bodyHTML":"<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #3312.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"644606709\" data-permission-text=\"Title is private\" data-url=\"https://github.com/elastic/cloud-on-k8s/issues/3312\" data-hovercard-type=\"issue\" data-hovercard-url=\"/elastic/cloud-on-k8s/issues/3312/hovercard\" href=\"https://github.com/elastic/cloud-on-k8s/issues/3312\">#3312</a></p>\n<p>Removing just the value does not work as Kibana still chokes on the parent:</p>\n<blockquote>\n<p>{\"type\":\"log\",\"<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/timestamp/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/timestamp\">@timestamp</a>\":\"2020-06-24T16:32:13Z\",\"tags\":[\"fatal\",\"root\"],\"pid\":1,\"message\":\"{ Error: \"xpack.encryptedSavedObjects\" setting was not applied. Check for spelling errors and ensure that expected plugins are installed.\\n    at KbnServer.exports.default (/usr/share/kibana/src/server/config/complete.js:88:17) code: 'InvalidConfig', processExitCode: 64 }\"}</p>\n</blockquote>\n<blockquote>\n<p>FATAL  Error: \"xpack.encryptedSavedObjects\" setting was not applied. Check for spelling errors and ensure that expected plugins are installed.</p>\n</blockquote>\n<p>Checking with the beats folks if they would be open to us adding an <code>omitempty</code> like tag for go-ucfg so we can avoid doing this in the future. From what I could see there was not a way to do something like that when unpacking currently, thus this method.</p>","labels":{"edges":[{"node":{"name":">bug"}},{"node":{"name":"exclude-from-release-notes"}},{"node":{"name":"v1.2.0"}}]}},{"number":3309,"title":"Update ECK version in docs","merged":false,"bodyHTML":"<p>Update the ECK version attribute in docs to point to 1.2.0</p>","labels":{"edges":[{"node":{"name":">docs"}},{"node":{"name":"v1.2.0"}}]}},{"number":3301,"title":"Bump Elastic Stack version to 7.8.0","merged":true,"bodyHTML":"<p>Make <code>7.8.0</code> the new default Elastic Stack version.</p>","labels":{"edges":[{"node":{"name":">non-issue"}},{"node":{"name":"v1.2.0"}}]}},{"number":3300,"title":"Always change Beat health to red if none of pods are ready","merged":true,"bodyHTML":"<p>Right now Beat health is green if <code>ready</code> count is equal to <code>desired</code> count. This works well if Beat is scaled down to 0 and indicates that manifest was applied successfully. Unfortunately, <code>desired</code> is taken from deployment/daemonSet status which can be 0 when there is an issue with creating Pods. This happens, for example, when appropriate PSP can't be found.</p>\n<p>This PR always sets health to red if no Pods are ready as this seems to better reflect what user would be expecting.</p>","labels":{"edges":[{"node":{"name":":beats"}},{"node":{"name":">enhancement"}},{"node":{"name":"exclude-from-release-notes"}},{"node":{"name":"v1.2.0"}}]}},{"number":3295,"title":"Do not manage keystore if already initialized","merged":true,"bodyHTML":"<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #3294.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"641222661\" data-permission-text=\"Title is private\" data-url=\"https://github.com/elastic/cloud-on-k8s/issues/3294\" data-hovercard-type=\"issue\" data-hovercard-url=\"/elastic/cloud-on-k8s/issues/3294/hovercard\" href=\"https://github.com/elastic/cloud-on-k8s/issues/3294\">#3294</a> by creating a file to record if the keystore has been initialized.</p>","labels":{"edges":[{"node":{"name":">bug"}},{"node":{"name":"v1.2.0"}}]}},{"number":3292,"title":"Add drivers for packetbeat, journalbeat and auditbeat","merged":true,"bodyHTML":"<p>This PR adds packetbeat, journalbeat and auditbeat as well-known Beat types. This allows to setup dashboards when <code>kibanaRef</code> is provided (when Beat supports it), precreate roles for those Beat types and choose the right image.</p>\n<p>All three Beats have E2E tests added with exemplary configs together with required PSPs.</p>","labels":{"edges":[{"node":{"name":":beats"}},{"node":{"name":">enhancement"}},{"node":{"name":"exclude-from-release-notes"}},{"node":{"name":"v1.2.0"}}]}},{"number":3285,"title":"Add additional Kibana encryption keys","merged":true,"bodyHTML":"<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #2279.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"539297329\" data-permission-text=\"Title is private\" data-url=\"https://github.com/elastic/cloud-on-k8s/issues/2279\" data-hovercard-type=\"issue\" data-hovercard-url=\"/elastic/cloud-on-k8s/issues/2279/hovercard\" href=\"https://github.com/elastic/cloud-on-k8s/issues/2279\">#2279</a> by setting the additional encryption keys if they are not explicitly set already</p>\n<p>Also changes <code>server.host</code> from <code>0</code> to <code>0.0.0.0</code> because this was being thrown in the logs:</p>\n<blockquote>\n<p>{\"type\":\"log\",\"<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/timestamp/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/timestamp\">@timestamp</a>\":\"2020-06-17T19:39:10Z\",\"tags\":[\"error\",\"reporting\"],\"pid\":6,\"message\":\"Error: Found 'server.host: \"0\"' in settings. This is incompatible with Reporting. To enable Reporting to work, 'xpack.reporting.kibanaServer.hostname: 0.0.0.0' is being automatically to the configuration. You can change to 'server.host: 0.0.0.0' or add 'xpack.reporting.kibanaServer.hostname: 0.0.0.0' in kibana.yml to prevent this message.\\n    at validateServerHost (/usr/share/kibana/x-pack/legacy/plugins/reporting/server/lib/validate/validate_server_host.js:24:11)\\n    at runValidations (/usr/share/kibana/x-pack/legacy/plugins/reporting/server/lib/validate/index.js:25:256)\\n    at ReportingPlugin.setup (/usr/share/kibana/x-pack/legacy/plugins/reporting/server/plugin.js:40:5)\"}</p>\n</blockquote>\n<p>And there wasn't any mention in the <a href=\"https://www.elastic.co/guide/en/kibana/current/settings.html\" rel=\"nofollow\">Kibana config docs</a>, but the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-network.html\" rel=\"nofollow\">ES docs</a> indicate 0 should be semantically equivalent to 0.0.0.0</p>\n<p>This resolved most of the startup warnings for Kibana, another one that stands out is:</p>\n<blockquote>\n<p>{\"type\":\"log\",\"<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/timestamp/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/timestamp\">@timestamp</a>\":\"2020-06-17T19:39:07Z\",\"tags\":[\"warning\",\"reporting\"],\"pid\":6,\"message\":\"Enabling the Chromium sandbox provides an additional layer of protection.\"}</p>\n</blockquote>\n<p>Which seems like a false alarm since the <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-chromium-sandbox.html#_docker\" rel=\"nofollow\">docs</a> recommend disabling it in docker. Reached out to the kibana team for clarity there</p>","labels":{"edges":[{"node":{"name":">enhancement"}},{"node":{"name":"release-highlight"}},{"node":{"name":"v1.2.0"}}]}},{"number":3282,"title":"Suggest starting an ECK trial license in Enterprise Search docs","merged":true,"bodyHTML":"<p>In order to start Workplace Search users will need an Elastic license. A<br>\ngreat way to try it is to start a trial license.<br>\nWhile a trial can be started by clicking a button on the UI, we want to<br>\nencourage users to start a trial at ECK level, so that:</p>\n<ul>\n<li>they also benefit from ECK licensed features</li>\n<li>they don't hit a bug in Enterprise Search 7.7.0 (fixed in 7.8.0) where<br>\nthe start trial call returns an error 500 (once)</li>\n</ul>","labels":{"edges":[{"node":{"name":">docs"}},{"node":{"name":"v1.2.0"}}]}},{"number":3279,"title":"Allow a single configRef to be specified in Enterprise Search","merged":true,"bodyHTML":"<p>Let's be consistent with the Beat CRD, and accept a single secret reference in <code>configRef</code>.</p>\n<p>Chances that people would like to use multiple secrets are rather small, and we could still add a plural <code>configRefs</code> later.</p>\n<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #3221.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"637016621\" data-permission-text=\"Title is private\" data-url=\"https://github.com/elastic/cloud-on-k8s/issues/3221\" data-hovercard-type=\"issue\" data-hovercard-url=\"/elastic/cloud-on-k8s/issues/3221/hovercard\" href=\"https://github.com/elastic/cloud-on-k8s/issues/3221\">#3221</a>.</p>","labels":{"edges":[{"node":{"name":">enhancement"}},{"node":{"name":"exclude-from-release-notes"}},{"node":{"name":"v1.2.0"}}]}},{"number":3277,"title":"Fix Enterprise Search mounted volumes for restricted environments","merged":true,"bodyHTML":"<p>Running Enterprise Search on a restricted environment (Openshift) failed for a few reasons.<br>\nThis PR fixes it.</p>\n<h2>1. Permission to write the configuration file</h2>\n<p>Enterprise Search attempts to overwrite the content of <code>/usr/share/enterprise-search/enterprise-search.yml</code> with configuration settings from environment variables, unless that file is already not the default one. Even though we mounted the configuration file in a different place. When that happens, the Enterprise Search process may not have permissions to write in that folder that is restricted to the <code>enterprise-search</code> user.</p>\n<p>To deal with this, we can simply mount the configuration file directly in <code>/usr/share/enterprise-search/enterprise-search.yml</code>. Enterprise Search detects this file is not the default one and does not attempt to modify it.</p>\n<p>To keep the number of secrets small, we keep the readiness probe in the same secret as the configuration file. For that reason, the PR introduces a second volume dedicated to the readiness probe script (mounted in <code>/mnt/elastic-internal/scripts/readiness-probe.sh</code>), that relies on the same Secret as the config volume.</p>\n<h2>2. Permission to write logs</h2>\n<p>Enterprise Search writes logs to <code>/var/log/enterprise-search</code> by default, but may not have permissions to create that directory. To fix it, we mount an emptyDir in <code>/var/log/enterprise-search</code>. Which is a good idea anyway in order to not have the container disk usage grow with logs. We already do the same for Elasticsearch.</p>\n<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #3274.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"640267618\" data-permission-text=\"Title is private\" data-url=\"https://github.com/elastic/cloud-on-k8s/issues/3274\" data-hovercard-type=\"issue\" data-hovercard-url=\"/elastic/cloud-on-k8s/issues/3274/hovercard\" href=\"https://github.com/elastic/cloud-on-k8s/issues/3274\">#3274</a>.</p>","labels":{"edges":[{"node":{"name":">bug"}},{"node":{"name":"exclude-from-release-notes"}},{"node":{"name":"v1.2.0"}}]}}],"pageInfo":{"hasNextPage":true,"endCursor":"Y3Vyc29yOjEw"}}}}